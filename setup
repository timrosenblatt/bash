echo "This script assumes it lives in ~/workspace/dotfiles"
echo "This installs a lot of things. Hit control+c if you want to quit"

sleep 5

# No need to install git, because that's how this file got here

if [ -d ~/Applications/iTerm.app ]; then
  echo "iTerm is already installed"
else
  echo "Installing iTerm"
  curl -O https://iterm2.com/downloads/stable/iTerm2-3_3_6.zip
  unzip iTerm2-3_3_6.zip
  mv iTerm.app/ ~/Applications/
  rm iTerm2-3_3_6.zip
fi


if [ -d ~/liquidprompt ]; then
  echo "Liquid Prompt already installed, skipping.."
else
  cd
  git clone https://github.com/nojhan/liquidprompt.git
fi



# https://www.atlassian.com/blog/git/advanced-git-aliases
# https://github.com/billmei/dotfiles/blob/master/.gitconfig
echo "Customizing git config"
git config --global commit.template ~/workspace/dotfiles/git/gitmessage

git config --global alias.co checkout
git config --global alias.forget '!git add -A && git checkout -f'

git config --global push.default current


# check if the ssh config file is being included
# per https://superuser.com/questions/247564/is-there-a-way-for-one-ssh-config-file-to-include-another-one
# I need OpenSSH 7.3p1 which can be tested with "ssh -V" but I don't feel like parsing it -- most modern
# systems are going to have it.

# Check for "Include ~/workspace/dotfiles/ssh/config" and include it if not there


echo "Checking Homebrew"
brew --version
if [ $? -eq 0 ]; then
  echo "Homebrew already installed"
else
  /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
fi



echo "Checking VSCode"
code --version
if [ $? -eq 0 ]; then
  echo "VSCode is installed. Installing extensions..."

  code --install-extension rebornix.ruby
  code --install-extension karunamurti.haml
  code --install-extension knisterpeter.vscode-github
else
  echo "Installing VSCode"
  brew cask install visual-studio-code
fi



# This may require updating the path. Might be ~/Library/Python/3.7/bin/ or whereever
# that Python is installing binaries.
echo "Checking AWS CLI"
aws --version
if [ $? -eq 0 ]; then
  echo "AWS CLI is installed. Skipping"
else
  pip3 install awscli --upgrade --user
fi


echo "Done! Be sure to add 'source_me' to the .bash_profile"

# Consider installing https://github.com/segmentio/aws-okta